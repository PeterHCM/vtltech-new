@inherits UmbracoViewPage<Umbraco.Cms.Core.Models.Blocks.BlockGridItem>
@using Umbraco.Extensions
@using Umbraco.Cms.Core.Models

@{
    var content = Model.Content;
    var columnSpan = Model.ColumnSpan;
    
    // Mapping Tailwind Class (Bắt buộc để Tailwind nhận diện được class)
    var gridClasses = columnSpan switch {
        1 => "lg:col-span-1",
        2 => "lg:col-span-2",
        3 => "lg:col-span-3",
        4 => "lg:col-span-4",
        6 => "lg:col-span-6",
        8 => "lg:col-span-8",
        9 => "lg:col-span-9",
        _ => "lg:col-span-12"
    };

    var title = content.Value<string>("title");
    var description = content.Value<string>("description");
    var ctaLinks = content.Value<IEnumerable<Link>>("buttonLink");
    var layout = content.Value<string>("layout") ?? "Ngang"; // Mặc định là Ngang
}

<div class="col-span-12 @gridClasses">
    @if (layout == "Ngang")
    {
        @* Layout Ngang: Thường dùng làm Banner hành động giữa trang *@
        <div class="relative overflow-hidden bg-secondary rounded-2xl p-8 md:p-12 shadow-xl group">
            @* Decor trang trí phía sau *@
            <div class="absolute -right-10 -top-10 w-40 h-40 bg-white/5 rounded-full blur-3xl group-hover:bg-primary/20 transition-all duration-700"></div>
            
            <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-8">
                <div class="text-center md:text-left">
                    @if (!string.IsNullOrWhiteSpace(title))
                    {
                        <h3 class="text-2xl md:text-3xl font-bold text-white mb-2">@title</h3>
                    }
                    @if (!string.IsNullOrWhiteSpace(description))
                    {
                        <p class="text-white/80 max-w-xl">@Html.Raw(description.Replace("\n", "<br />"))</p>
                    }
                </div>

                @if (ctaLinks?.Any() == true)
                {
                    <div class="flex flex-wrap gap-4 justify-center">
                        @foreach (var link in ctaLinks)
                        {
                            <a href="@link.Url" target="@link.Target" rel="noopener"
                                class="vtl-btn-primary">
                                @link.Name
                            </a>
                        }
                    </div>
                }
            </div>
        </div>
    }
    else
    {    
        @* Layout Dọc: Dùng cho các box nội dung thông thường *@
        <div class="vtl-block-adaptive p-8 flex flex-col justify-center items-center text-center h-full">
            @if (!string.IsNullOrWhiteSpace(title))
            {
                <h3 class="vtl-section-title !text-2xl mb-4">@title</h3>
            }

            @if (!string.IsNullOrWhiteSpace(description))
            {
                <p class="text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
                    @Html.Raw(description.Replace("\n", "<br />"))
                </p>
            }

            @if (ctaLinks?.Any() == true)
            {
                <div class="flex flex-wrap gap-4 justify-center">
                    @foreach (var link in ctaLinks)
                    {
                        <a href="@link.Url" target="@link.Target" rel="noopener"
                        class="vtl-btn-primary">
                            @link.Name
                        </a>
                    }
                </div>
            }
            @if (string.IsNullOrWhiteSpace(title) && string.IsNullOrWhiteSpace(description) && (ctaLinks == null || !ctaLinks.Any()))
            {
                <div class="p-4 border-2 border-dashed border-gray-300 rounded-xl text-gray-400 italic">
                    CTA Block - Chưa nhập nội dung.
                </div>
            }
        </div>    
    }
</div>