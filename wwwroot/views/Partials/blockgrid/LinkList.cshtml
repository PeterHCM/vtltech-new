@inherits UmbracoViewPage<Umbraco.Cms.Core.Models.Blocks.BlockGridItem>
@using Umbraco.Extensions
@using Umbraco.Cms.Core.Models
@using Microsoft.AspNetCore.Mvc.ViewFeatures
@{
    var content = Model.Content;
    var columnSpan = Model.ColumnSpan; // Số cột (1-12)
    
    // Mapping Tailwind Class để đảm bảo Tailwind nhận diện được class (không dùng nối chuỗi động)
    var gridClasses = columnSpan switch {
        1 => "lg:col-span-1",
        2 => "lg:col-span-2",
        3 => "lg:col-span-3",
        4 => "lg:col-span-4",
        5 => "lg:col-span-5",
        6 => "lg:col-span-6",
        7 => "lg:col-span-7",
        8 => "lg:col-span-8",
        9 => "lg:col-span-9",
        10 => "lg:col-span-10",
        11 => "lg:col-span-11",
        _ => "lg:col-span-12"
    };

    var fileType = content.Value<string>("fileType")?.ToLowerInvariant() ?? "link";
    var title = content.Value<string>("title");
    var description = content.Value<string>("description");
    var links = content.Value<IEnumerable<Link>>("links");
}

<div class="col-span-12 @gridClasses flex flex-col h-full animate-fade-in">
    <div class="vtl-block-adaptive p-6 md:p-8 flex flex-col h-full hover:shadow-2xl transition-all duration-300 border border-gray-100 dark:border-white/10 rounded-2xl group">
        
        @if (!string.IsNullOrEmpty(title))
        {
            <h3 class="text-xl md:text-2xl font-bold text-gray-900 dark:text-white mb-4 group-hover:text-primary transition-colors">
                @title
            </h3>
            <div class="w-12 h-1 bg-primary/20 group-hover:w-20 group-hover:bg-primary transition-all duration-500 mb-6 rounded-full"></div>
        }

        @if (!string.IsNullOrEmpty(description))
        {
            <div class="text-gray-600 dark:text-gray-400 mb-8 leading-relaxed flex-grow">
                @Html.Raw(description.Replace("\n", "<br>"))
            </div>
        }

        @if (links?.Any() == true)
        {
            <div class="mt-auto">
                @{
                    var partialViewData = new ViewDataDictionary(ViewData);
                    partialViewData["fileType"] = fileType;
                }
                @await Html.PartialAsync("Partials/Shared/LinkList", links, partialViewData)
            </div>
        }
    </div>
</div>