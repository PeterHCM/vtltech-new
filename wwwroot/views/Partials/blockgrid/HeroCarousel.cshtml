@inherits UmbracoViewPage<BlockGridItem>
@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Core.Models
@using Umbraco.Extensions

<section class="pb-10 min-h-screen">
@{
    var content = Model.Content;
    var banners = content.Value<BlockListModel>("banners");
}
@if (banners != null && banners.Any())
{
    <div class="swiper hero-swiper relative overflow-hidden">
        <div class="swiper-wrapper">
            @foreach (var banner in banners)
            {
                var b = banner.Content;
                var heading = b.Value<string>("heading");
                var subtitle = b.Value<string>("subtitle");
                var ctaLinks = b.Value<IEnumerable<Link>>("ctaLinks");
                var images = b.Value<IEnumerable<MediaWithCrops>>("images");
                var icons = b.Value<IEnumerable<MediaWithCrops>>("icons");

                var image = images?.FirstOrDefault();
                var icon = icons?.FirstOrDefault();

                <div class="swiper-slide relative h-[500px] sm:h-[600px]">
                    <div class="relative w-full h-full flex items-center justify-center bg-gray-100 dark:bg-gray-900 text-center sm:text-left px-6 sm:px-12 overflow-hidden">
                        @if (image != null)
                        {
                            <div class="absolute inset-0 z-0">
                                <img src="@image.Url()" alt="@heading"
                                     class="w-full h-full object-cover transition-transform duration-1000 ease-out swiper-zoom-target scale-100"
                                     style="will-change: transform;" aria-hidden="true" />
                                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                            </div>
                        }

                        <div class="relative z-10 max-w-3xl py-12 sm:py-0">
                            @if (icon != null)
                            {
                                <img src="@icon.Url()" alt="Icon" class="w-auto h-20 mb-4 mx-auto sm:mx-0" />
                            }
                            @if (!string.IsNullOrEmpty(heading))
                            {
                                <h2 class="text-2xl sm:text-5xl font-bold text-white mb-4 leading-tight">@heading</h2>
                            }

                            @if (!string.IsNullOrEmpty(subtitle))
                            {
                                <p class="text-base sm:text-xl text-white/90 mb-6">@subtitle</p>
                            }

                            @if (ctaLinks != null)
                            {
                                <div class="flex flex-wrap justify-center sm:justify-start gap-4">
                                    @foreach (var link in ctaLinks)
                                    {
                                        <a href="@link.Url" target="@link.Target" rel="noopener"
                                           class="bg-primary text-white hover:bg-secondary font-semibold px-5 py-3 rounded transition duration-200">
                                            @link.Name
                                        </a>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }
        </div>

        <!-- Navigation with Heroicons -->
        <button class="swiper-button-prev absolute left-4 top-1/2 transform -translate-y-1/2 z-20 bg-black/30 hover:bg-black/50 text-white p-2 rounded-full" aria-label="Previous slide" title="Previous slide">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </button>
        <button class="swiper-button-next absolute right-4 top-1/2 transform -translate-y-1/2 z-20 bg-black/30 hover:bg-black/50 text-white p-2 rounded-full" aria-label="Next slide" title="Next slide">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
        </button>

        <div class="swiper-pagination"></div>
    </div>
}
</section>


<!-- Swiper JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
    const swiper = new Swiper('.hero-swiper', {
        loop: true,
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        effect: 'fade',
        fadeEffect: {
            crossFade: true
        },
        zoom: {
            maxRatio: 1.1,
        },
        autoHeight: true,
        on: {
            slideChangeTransitionStart: () => {
                document.querySelectorAll('.swiper-zoom-target').forEach(img => {
                    img.classList.remove('scale-110');
                });
            },
            slideChangeTransitionEnd: () => {
                const activeSlide = document.querySelector('.swiper-slide-active .swiper-zoom-target');
                if (activeSlide) {
                    activeSlide.classList.add('scale-110');
                }
            }
        }
    });
</script>
