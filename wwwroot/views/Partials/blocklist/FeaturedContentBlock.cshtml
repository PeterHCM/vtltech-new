@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Core.Models.PublishedContent
@using Umbraco.Extensions
@inherits UmbracoViewPage<BlockListItem>

@{
    var content = Model.Content;
    var title = content.Value<string>("title");
    var cards = content.Value<BlockListModel>("cards");
}

<section class="py-12 bg-white text-gray-800 dark:bg-dark dark:text-slogan">
    <div class="container mx-auto px-4">
        @if (!string.IsNullOrWhiteSpace(title))
        {
            <h2 class="text-3xl font-bold mb-8 text-primary">@title</h2>
        }

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            @foreach (var card in cards ?? Enumerable.Empty<BlockListItem>())
            {
                var cardContent = card.Content;

                var cardTitle = cardContent.Value<string>("title");
                var cardDescription = cardContent.Value<string>("description");

                var iconMedia = cardContent.Value<IEnumerable<IPublishedContent>>("icon")?.FirstOrDefault();
                var iconUrl = iconMedia?.Url();

                var imageMedia = cardContent.Value<IEnumerable<IPublishedContent>>("image")?.FirstOrDefault();
                var imageUrl = imageMedia?.Url();

                <div class="bg-gray-100 dark:bg-neutral-900 shadow-xl rounded-lg overflow-hidden">
                    @if (!string.IsNullOrEmpty(imageUrl))
                    {
                        <img src="@imageUrl" alt="@cardTitle" class="w-full h-48 object-cover" />
                    }
                    else
                    {
                        <div class="w-full h-48 bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm text-gray-400 dark:text-gray-500">
                            Chưa có ảnh
                        </div>
                    }

                    <div class="p-6">
                        <div class="flex items-center gap-2 mb-2">
                            @if (!string.IsNullOrEmpty(iconUrl))
                            {
                                <img src="@iconUrl" alt="icon" class="w-6 h-6" />
                            }
                            <h3 class="text-xl font-semibold text-primary">@cardTitle</h3>
                        </div>
                        <p class="text-sm line-clamp-3 text-gray-600 dark:text-gray-400">@cardDescription</p>
                    </div>
                </div>
            }
        </div>
    </div>
</section>