@using Umbraco.Extensions
@using Umbraco.Cms.Core.Models.PublishedContent
@model IEnumerable<IPublishedContent>

@if (Model?.Any() == true)
{
    var slideCount = Model.Count();

    <div
        x-data="{
            index: 0,
            total: @slideCount,
            timer: null,
            next() {
                this.index = (this.index + 1) % this.total
            },
            prev() {
                this.index = (this.index - 1 + this.total) % this.total
            },
            start() {
                this.stop()
                this.timer = setInterval(() => this.next(), 5000)
            },
            stop() {
                if (this.timer) clearInterval(this.timer)
            }
        }"
        x-init="start()"
        @@mouseenter="stop()"
        @@mouseleave="start()"
        class="relative w-full overflow-hidden rounded-lg">

        <!-- TRACK (KHÔNG BẮT CHUỘT) -->
        <div
            class="flex transition-transform duration-500 ease-in-out pointer-events-none"
            :style="`transform: translateX(-${index * 100}%)`">

            @foreach (var img in Model)
            {
                <div class="w-full flex-shrink-0 aspect-[16/9]">
                    <img
                        src="@img.Url()?width=1200&quality=85"
                        alt="@img.Name"
                        class="w-full h-full object-cover"
                        loading="lazy" />
                </div>
            }
        </div>

        <!-- PREV -->
        <button
            type="button"
            @@click.prevent="stop(); prev(); start()"
            class="absolute left-3 top-1/2 -translate-y-1/2 z-50 bg-black/40 text-white p-2 rounded-full pointer-events-auto">
            ‹
        </button>

        <!-- NEXT -->
        <button
            type="button"
            @@click.prevent="stop(); next(); start()"
            class="absolute right-3 top-1/2 -translate-y-1/2 z-50 bg-black/40 text-white p-2 rounded-full pointer-events-auto">
            ›
        </button>
    </div>
}
