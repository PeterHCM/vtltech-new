@using Umbraco.Extensions
@using Umbraco.Cms.Core.Models.PublishedContent
@model IEnumerable<IPublishedContent>

@if (Model?.Any() == true)
{
    var images = Model.ToList();

    <div
        x-data="{
            active: 0,
            images: [
                @foreach (var img in images)
                {
                    <text>
                        {
                            url: '@img.Url()',
                            name: '@img.Name'
                        }@(img != images.Last() ? "," : "")
                    </text>
                }
            ]
        }"
        class="space-y-4">

        <div class="aspect-video overflow-hidden rounded-[1.5rem] md:rounded-[2.5rem] relative bg-gray-100 dark:bg-gray-800 shadow-xl ring-1 ring-black/5">
            <img
                :key="active"
                :src="images[active].url"
                :alt="images[active].name"
                class="w-full h-full object-cover"
                x-transition:enter="transition ease-out duration-500"
                x-transition:enter-start="opacity-0 scale-105"
                x-transition:enter-end="opacity-100 scale-100"
                loading="lazy" />
            
            @* Tag số lượng ảnh góc phải - màu Brand Xanh *@
            <div class="absolute bottom-4 right-6 bg-[#006361]/80 backdrop-blur-md text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-widest">
                <span x-text="active + 1"></span> / @images.Count
            </div>
        </div>

        <div class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-3">
            <template x-for="(img, index) in images" :key="index">
                <div
                    @@click="active = index"
                    :class="active === index 
                        ? 'border-[#e06800] ring-4 ring-[#e06800]/20' 
                        : 'border-transparent opacity-60 hover:opacity-100 hover:border-gray-200'"
                    class="aspect-square overflow-hidden rounded-2xl cursor-pointer border-2 transition-all duration-300 bg-white dark:bg-gray-900 shadow-sm">

                    <img
                        :src="img.url"
                        :alt="img.name"
                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                        loading="lazy" />
                </div>
            </template>
        </div>
    </div>
}
else
{
    <div class="py-8 text-center rounded-[2rem] border-2 border-dashed border-gray-100 dark:border-gray-800">
        <p class="text-sm text-gray-400 italic">
            Chưa có hình ảnh nào được tải lên.
        </p>
    </div>
}